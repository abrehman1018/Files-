description,name
adversaries may abuse task scheduling functionality to facilitate initial or recurring execution of malicious code on android and ios apis and libraries exist to facilitate scheduling tasks to execute at a specified date time or interval on android the workmanager api allows asynchronous tasks to be scheduled with the system workmanager was introduced to unify task scheduling on android using jobscheduler gcmnetworkmanager and alarmmanager internally workmanager offers a lot of flexibility for scheduling including periodically one time or constraint based e g only when the device is charging citation android workmanager on ios the nsbackgroundactivityscheduler api allows asynchronous tasks to be scheduled with the system the tasks can be scheduled to be repeating or non repeating however the system chooses when the tasks will be executed the app can choose the interval for repeating tasks or the delay between scheduling and execution for one time tasks citation apple nsbackgroundactivityscheduler ,Scheduled Task/Job
adversaries may use code injection attacks to implant arbitrary code into the address space of a running application code is then executed or interpreted by that application adversaries utilizing this technique may exploit capabilities to load code in at runtime through dynamic libraries with root access ptrace can be used to target specific applications and load shared libraries into its process memory citation shunix code injection mar 2016 citation fadeev code injection aug 2018 by injecting code an adversary may be able to gain access to higher permissions held by the targeted application by executing as the targeted application in addition the adversary may be able to evade detection or enable persistent access to a system under the guise of the application s process citation google triada june 2019 ,Code Injection
adversaries may attempt to position themselves between two or more networked devices to support follow on behaviors such as transmitted data manipulation https attack mitre org techniques t1565 002 or endpoint denial of service https attack mitre org techniques t1642 adversary in the middle https attack mitre org techniques t1638 can be achieved through several mechanisms for example a malicious application may register itself as a vpn client effectively redirecting device traffic to adversary owned resources registering as a vpn client requires user consent on both android and ios additionally a special entitlement granted by apple is needed for ios devices alternatively a malicious application with escalation privileges may utilize those privileges to gain access to network traffic specific to android devices adversary in the disk is a type of aitm attack where adversaries monitor and manipulate data that is exchanged between applications and external storage citation mitd_kaspersky citation mitd_checkpoint citation mitd_checkpoint_research to accomplish this a malicious application firsts requests for access to multimedia files on the device read_external storage and write_external_storage then the application reads data on the device and or writes malware to the device though the request for access is common when used maliciously adversaries may access files and other sensitive data due to abusing the permission multiple applications were shown to be vulnerable against this attack however scrutiny of permissions and input validations may mitigate this attack outside of a mobile device adversaries may be able to capture traffic by employing a rogue base station or wi fi access point these devices will allow adversaries to capture network traffic after it has left the device while it is flowing to its destination on a local network enterprise techniques could be used such as arp cache poisoning https attack mitre org techniques t1557 002 or dhcp spoofing https attack mitre org techniques t1557 003 if applications properly encrypt their network traffic sensitive data may not be accessible to adversaries depending on the point of capture for example properly implementing apple s application transport security ats and android s network security configuration nsc may prevent sensitive data leaks citation nsc_android ,Adversary-in-the-Middle
adversaries may circumvent mechanisms designed to control elevated privileges to gain higher level permissions most modern systems contain native elevation control mechanisms that are intended to limit privileges that a user can gain on a machine authorization has to be granted to specific users in order to perform tasks that are designated as higher risk an adversary can use several methods to take advantage of built in control mechanisms in order to escalate privileges on a system ,Abuse Elevation Control Mechanism
adversaries may use legitimate remote access software such as vnc teamviewer airdroid airmirror etc to establish an interactive command and control channel to target mobile devices remote access applications may be installed and used post compromise as an alternate communication channel for redundant access or as a way to establish an interactive remote session with the target device they may also be used as a component of malware to establish a reverse connection to an adversary controlled system or service installation of remote access tools may also include persistence ,Remote Access Software
test,Malicious SMS Message
an adversary who is able to obtain unauthorized access to or misuse authorized access to cloud backup services e g google s android backup service or apple s icloud could use that access to obtain sensitive data stored in device backups for example the elcomsoft phone breaker product advertises the ability to retrieve ios backup data from apple s icloud citation elcomsoft eppb elcomsoft also describes citation elcomsoft whatsapp obtaining whatsapp communication histories from backups stored in icloud ,Obtain Device Cloud Backups
adversaries may include functionality in malware that uninstalls the malicious application from the device this can be achieved by abusing device owner permissions to perform silent uninstallation using device owner api calls abusing root permissions to delete files from the filesystem abusing the accessibility service this requires sending an intent to the system to request uninstallation and then abusing the accessibility service to click the proper places on the screen to confirm uninstallation ,Uninstall Malicious Application
adversaries may delete alter or hide generated artifacts on a device including files jailbreak status or the malicious application itself these actions may interfere with event collection reporting or other notifications used to detect intrusion activity this may compromise the integrity of mobile security solutions by causing notable events or information to go unreported ,Indicator Removal on Host
adversaries may manipulate products or product delivery mechanisms prior to receipt by a final consumer for the purpose of data or system compromise supply chain compromise can take place at any stage of the supply chain including manipulation of development tools manipulation of a development environment manipulation of source code repositories public or private manipulation of source code in open source dependencies manipulation of software update distribution mechanisms compromised infected system images replacement of legitimate software with modified versions sales of modified counterfeit products to legitimate distributors shipment interdiction while supply chain compromise can impact any component of hardware or software attackers looking to gain execution have often focused on malicious additions to legitimate software in software distribution or update channels targeting may be specific to a desired victim set or malicious software may be distributed to a broad set of consumers but only move on to additional tactics on specific victims popular open source projects that are used as dependencies in many applications may also be targeted as a means to add malicious code to users of the dependency specifically with the widespread usage of third party advertising libraries citation grace advertisement citation nowsecure remotecode ,Supply Chain Compromise
adversaries may exploit the lack of authentication in signaling system network nodes to track the to track the location of mobile devices by impersonating a node citation engel ss7 citation engel ss7 2008 citation 3gpp security citation positive ss7 citation csric5 wg10 finalreport by providing the victim s msisdn phone number and impersonating network internal nodes to query subscriber information from other nodes adversaries may use data collected from each hop to eventually determine the device s geographical cell area or nearest cell tower citation engel ss7 ,Impersonate SS7 Nodes
adversaries may match or approximate the name or location of legitimate files or resources when naming placing them this is done for the sake of evading defenses and observation this may be done by giving artifacts the name and icon of a legitimate trusted application i e settings or using a package name that matches legitimate trusted applications i e com google android gm adversaries may also use the same icon of the file or application they are trying to mimic ,Match Legitimate Name or Location
,Insecure Third-Party Libraries
adversaries may utilize standard operating system apis to collect data from permission backed data stores on a device such as the calendar or contact list these permissions need to be declared ahead of time on android they must be included in the application s manifest on ios they must be included in the application s info plist file in almost all cases the user is required to grant access to the data store that the application is trying to access in recent os versions vendors have introduced additional privacy controls for users such as the ability to grant permission to an application only while the application is being actively used by the user if the device has been jailbroken or rooted an adversary may be able to access protected user data https attack mitre org techniques t1636 without the user s knowledge or approval ,Protected User Data
adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol asymmetric cryptography also known as public key cryptography uses a keypair per party one public that can be freely distributed and one private that should not be distributed due to how asymmetric algorithms work the sender encrypts data with the receiver s public key and the receiver decrypts the data with their private key this ensures that only the intended recipient can read the encrypted data common public key encryption algorithms include rsa elgamal and ecdsa for efficiency many protocols including ssl tls use symmetric cryptography once a connection is established but use asymmetric cryptography to establish or transmit a key as such these protocols are classified as asymmetric cryptography https attack mitre org techniques t1521 002 ,Asymmetric Cryptography
adversaries may attempt to get a listing of applications that are installed on a device adversaries may use the information from software discovery https attack mitre org techniques t1418 during automated discovery to shape follow on behaviors including whether or not to fully infect the target and or attempts specific actions adversaries may attempt to enumerate applications for a variety of reasons such as figuring out what security measures are present or to identify the presence of target applications ,Software Discovery
adversaries may attempt to get information about running processes on a device information obtained could be used to gain an understanding of common software applications running on devices within a network adversaries may use the information from process discovery https attack mitre org techniques t1424 during automated discovery to shape follow on behaviors including whether or not the adversary fully infects the target and or attempts specific actions recent android security enhancements have made it more difficult to obtain a list of running processes on android 7 and later there is no way for an application to obtain the process list without abusing elevated privileges this is due to the android kernel utilizing the hidepid mount feature prior to android 7 applications could utilize the ps command or examine the proc directory on the device citation android selinuxchanges in ios applications have previously been able to use the sysctl command to obtain a list of running processes this functionality has been removed in later ios versions ,Process Discovery
adversaries may utilize standard operating system apis to gather call log data on android this can be accomplished using the call log content provider ios provides no standard api to access the call log if the device has been jailbroken or rooted an adversary may be able to access the call log https attack mitre org techniques t1636 002 without the user s knowledge or approval ,Call Log
adversaries may attempt to get a listing of security applications and configurations that are installed on a device this may include things such as mobile security products adversaries may use the information from security software discovery https attack mitre org techniques t1418 001 during automated discovery to shape follow on behaviors including whether or not to fully infect the target and or attempt specific actions ,Security Software Discovery
,App Delivered via Email Attachment
adversaries may inject malicious code into processes via ptrace process trace system calls in order to evade process based defenses as well as possibly elevate privileges ptrace system call injection is a method of executing arbitrary code in the address space of a separate live process ptrace system call injection involves attaching to and modifying a running process the ptrace system call enables a debugging process to observe and control another process and each individual thread including changing memory and register values citation ptrace man ptrace system call injection is commonly performed by writing arbitrary code into a running process e g by using malloc then invoking that memory with ptrace_setregs to set the register containing the next instruction to execute ptrace system call injection can also be done with ptrace_poketext ptrace_pokedata which copy data to a specific address in the target process s memory e g the current address of the next instruction citation ptrace man citation medium ptrace jul 2018 ptrace system call injection may not be possible when targeting processes with high privileges and on some systems those that are non child processes citation bh linux inject running code in the context of another process may allow access to the process s memory system network resources and possibly elevated privileges execution via ptrace system call injection may also evade detection from security products since the execution is masked under a legitimate process ,Ptrace System Calls
adversaries may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms this not only involves impairing preventative defenses such as anti virus but also detection capabilities that defenders can use to audit activity and identify malicious behavior this may span both native defenses as well as supplemental capabilities installed by users or mobile endpoint administrators ,Impair Defenses
 this technique has been deprecated please use input capture https attack mitre org techniques t1417 input injection https attack mitre org techniques t1516 and input prompt https attack mitre org techniques t1411 where appropriate a malicious app could abuse android s accessibility features to capture sensitive data or perform other malicious actions citation skycure accessibility adversaries may abuse accessibility features on android to emulate a user s clicks for example to steal money from a user s bank account citation android trojan steals paypal 2fa citation banking trojans google play adversaries may abuse accessibility features on android devices to evade defenses by repeatedly clicking the back button when a targeted app manager or mobile security app is launched or when strings suggesting uninstallation are detected in the foreground this effectively prevents the malicious application from being uninstalled citation android trojan steals paypal 2fa ,Abuse Accessibility Features
adversaries may exploit remote services of enterprise servers workstations or other resources to gain unauthorized access to internal systems once inside of a network adversaries may exploit remote services by taking advantage of a mobile device s access to an internal enterprise network through local connectivity or through a virtual private network vpn exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program service or within the operating system software or kernel itself to execute adversary controlled code a common goal for post compromise exploitation of remote services is for lateral movement to enable access to a remote system an adversary may need to determine if the remote system is in a vulnerable state which may be done through network service scanning https attack mitre org techniques t1423 or other discovery methods these look for common vulnerable software that may be deployed in the network the lack of certain patches that may indicate vulnerabilities or security software that may be used to detect or contain remote exploitation servers are likely a high value target for lateral movement exploitation but endpoint systems may also be at risk if they provide an advantage or access to additional resources depending on the permissions level of the vulnerable remote service an adversary may achieve exploitation for privilege escalation https attack mitre org techniques t1404 as a result of lateral movement exploitation as well ,Exploitation of Remote Services
adversaries may communicate using application layer protocols associated with web protocols traffic to avoid detection network filtering by blending in with existing traffic commands to remote mobile devices and often the results of those commands will be embedded within the protocol traffic between the mobile client and server web protocols such as http and https are used for web traffic as well as well as notification services native to mobile messaging services such as google cloud messaging gcm and newly firebase cloud messaging fcm gcm fcm two way communication and apple push notification service apns one way server to device such notification services leverage http s via the respective api and are commonly abused on android and ios respectively in order blend in with routine device traffic making it difficult for enterprises to inspect ,Web Protocols
adversaries can steal user application access tokens as a means of acquiring credentials to access remote systems and resources this can occur through social engineering or uri hijacking and typically requires user action to grant access such as through a system open with dialogue application access tokens are used to make authorized api requests on behalf of a user and are commonly used as a way to access resources in cloud based applications and software as a service saas citation auth0 why you should always use access tokens to secure apis sept 2019 oauth is one commonly implemented framework used to issue tokens to users for access to systems an application desiring access to cloud based services or protected apis can gain entry through oauth 2 0 using a variety of authorization protocols an example of a commonly used sequence is microsoft s authorization code grant flow citation microsoft identity platform protocols may 2019 citation microsoft oauth code authorization flow june 2019 an oauth access token enables a third party application to interact with resources containing user data in the ways requested without requiring user credentials ,Steal Application Access Token
adversaries may attempt to avoid detection by hiding malicious behavior from the user by doing this an adversary s modifications would most likely remain installed on the device for longer allowing the adversary to continue to operate on that device while there are many ways this can be accomplished one method is by using the device s sensors by utilizing the various motion sensors on a device such as accelerometer or gyroscope an application could detect that the device is being interacted with that way the application could continue to run while the device is not in use but cease operating while the user is using the device hiding anything that would indicate malicious activity was ongoing accessing the sensors in this way does not require any permissions from the user so it would be completely transparent ,User Evasion
adversaries may employ various means to detect and avoid virtualization and analysis environments this may include changing behaviors after checking for the presence of artifacts indicative of a virtual machine environment vme or sandbox if the adversary detects a vme they may alter their malware s behavior to disengage from the victim or conceal the core functions of the payload they may also search for vme artifacts before dropping further payloads adversaries may use the information learned from virtualization sandbox evasion https attack mitre org techniques t1633 during automated discovery to shape follow on behaviors adversaries may use several methods to accomplish virtualization sandbox evasion https attack mitre org techniques t1633 such as checking for system artifacts associated with analysis or virtualization adversaries may also check for legitimate user activity to help determine if it is in an analysis environment ,Virtualization/Sandbox Evasion
adversaries may collect the keychain storage data from an ios device to acquire credentials keychains are the built in way for ios to keep track of users passwords and credentials for many services and features such as wi fi passwords websites secure notes certificates private keys and vpn credentials on the device the keychain database is stored outside of application sandboxes to prevent unauthorized access to the raw data standard ios apis allow applications access to their own keychain contained within the database by utilizing a privilege escalation exploit or existing root access an adversary can access the entire encrypted database citation apple keychain services citation elcomsoft decrypt keychain ,Keychain
an adversary may push an update to a previously benign application to add malicious code this can be accomplished by pushing an initially benign functional application to a trusted application store such as the google play store or the apple app store this allows the adversary to establish a trusted userbase that may grant permissions to the application prior to the introduction of malicious code then an application update could be pushed to introduce malicious code citation android_app_breaking_bad this technique could also be accomplished by compromising a developer s account this would allow an adversary to take advantage of an existing userbase without having to establish the userbase themselves ,Application Versioning
on versions of android prior to 4 1 an adversary may use a malicious application that holds the read_logs permission to obtain private keys passwords other credentials or other sensitive data stored in the device s system log on android 4 1 and later an adversary would need to attempt to perform an operating system privilege escalation attack to be able to access the log ,Access Sensitive Data in Device Logs
adversaries may abuse command and script interpreters to execute commands scripts or binaries these interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms most systems come with some built in command line interface and scripting capabilities for example android is a unix like os and includes a basic unix shell https attack mitre org techniques t1623 001 that can be accessed via the android debug bridge adb or java s runtime package adversaries may abuse these technologies in various ways as a means of executing arbitrary commands commands and scripts can be embedded in initial access https attack mitre org tactics ta0027 payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing c2 adversaries may also execute commands through interactive terminals shells ,Command and Scripting Interpreter
adversaries may disable security tools to avoid potential detection of their tools and activities this can take the form of disabling security software modifying selinux configuration or other methods to interfere with security tools scanning or reporting information this is typically done by abusing device administrator permissions or using system exploits to gain root access to the device to modify protected system files ,Disable or Modify Tools
adversaries may transfer tools or other files from an external system onto a compromised device to facilitate follow on actions files may be copied from an external adversary controlled system through the command and control channel or through alternate protocols with another tool such as ftp ,Ingress Tool Transfer
adversaries may dynamically establish connections to command and control infrastructure to evade common detections and remediations this may be achieved by using malware that shares a common algorithm with the infrastructure the adversary uses to receive the malware s communications this algorithm can be used to dynamically adjust parameters such as the domain name ip address or port number the malware uses for command and control ,Dynamic Resolution
the mobile device may be targeted for exploitation through its interface to cellular networks or other radio interfaces baseband vulnerability exploitation a message sent over a radio interface typically cellular but potentially bluetooth gps nfc wi fi citation projectzero broadcomwifi or other to the mobile device could exploit a vulnerability in code running on the device citation register basestation citation weinmann baseband malicious sms message an sms message could contain content designed to exploit vulnerabilities in the sms parser on the receiving device citation forbes iphonesms an sms message could also contain a link to a web site containing malicious content designed to exploit the device web browser vulnerable sim cards may be remotely exploited and reprogrammed via sms messages citation srlabs simcard ,Exploit via Radio Interfaces
adversaries may attempt to get a listing of services running on remote hosts including those that may be vulnerable to remote software exploitation methods to acquire this information include port scans and vulnerability scans from the mobile device this technique may take advantage of the mobile device s access to an internal enterprise network either through local connectivity or through a virtual private network vpn ,Network Service Scanning
adversaries may attempt to avoid detection by hiding malicious behavior from the user by doing this an adversary s modifications would most likely remain installed on the device for longer allowing the adversary to continue to operate on that device while there are many ways this can be accomplished one method is by using the device s sensors by utilizing the various motion sensors on a device such as accelerometer or gyroscope an application could detect that the device is being interacted with that way the application could continue to run while the device is not in use but cease operating while the user is using the device hiding anything that would indicate malicious activity was ongoing accessing the sensors in this way does not require any permissions from the user so it would be completely transparent ,User Evasion
adversaries may steal data by exfiltrating it over an existing command and control channel stolen data is encoded into the normal communications channel using the same protocol as command and control communications ,Exfiltration Over C2 Channel
adversaries may exploit software vulnerabilities in order to elevate privileges exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in an application service within the operating system software or kernel itself to execute adversary controlled code security constructions such as permission levels will often hinder access to information and use of certain techniques adversaries will likely need to perform privilege escalation to include use of software exploitation to circumvent those restrictions when initially gaining access to a device an adversary may be operating within a lower privileged process which will prevent them from accessing certain resources on the system vulnerabilities may exist usually in operating system components and applications running at higher permissions that can be exploited to gain higher levels of access on the system this could enable someone to move from unprivileged or user level permission to root permissions depending on the component that is vulnerable ,Exploitation for Privilege Escalation
adversaries may make forward or block phone calls without user authorization this could be used for adversary goals such as audio surveillance blocking or forwarding calls from the device owner or c2 communication several permissions may be used to programmatically control phone calls including answer_phone_calls allows the application to answer incoming phone calls citation android permissions call_phone allows the application to initiate a phone call without going through the dialer interface citation android permissions process_outgoing_calls allows the application to see the number being dialed during an outgoing call with the option to redirect the call to a different number or abort the call altogether citation android permissions manage_own_calls allows a calling application which manages its own calls through the self managed connectionservice apis citation android permissions bind_telecom_connection_service required permission when using a connectionservice citation android permissions write_call_log allows an application to write to the device call log potentially to hide malicious phone calls citation android permissions when granted some of these permissions an application can make a phone call without opening the dialer first however if an application desires to simply redirect the user to the dialer with a phone number filled in it can launch an intent using intent action_dial which requires no specific permissions this then requires the user to explicitly initiate the call or use some form of input injection https attack mitre org techniques t1516 to programmatically initiate it ,Call Control
adversaries may steal data by exfiltrating it over an un encrypted network protocol other than that of the existing command and control channel the data may also be sent to an alternate network location from the main command and control server adversaries may opt to obfuscate this data without the use of encryption within network protocols that are natively unencrypted such as http ftp or dns adversaries may employ custom or publicly available encoding compression algorithms such as base64 or embed data within protocol headers and fields ,Exfiltration Over Unencrypted Non-C2 Protocol
adversaries may establish persistence using system mechanisms that trigger execution based on specific events mobile operating systems have means to subscribe to events such as receiving an sms message device boot completion or other device activities an intent is a message passed between android applications or system components applications can register to receive broadcast intents at runtime which are system wide intents delivered to each app when certain events happen on the device such as network changes or the user unlocking the screen malicious applications can then trigger certain actions within the app based on which broadcast intent was received in addition to android system intents malicious applications can register for intents broadcasted by other applications this allows the malware to respond based on actions in other applications this behavior typically indicates a more intimate knowledge or potentially the targeting of specific devices users or applications in android 8 api level 26 broadcast intent behavior was changed limiting the implicit intents that applications can register for in the manifest in most cases applications that register through the manifest will no longer receive the broadcasts now applications must register context specific broadcast receivers while the user is actively using the app citation android changes to system broadcasts ,Broadcast Receivers
adversaries may communicate over a commonly used port to bypass firewalls or network detection systems and to blend with normal network activity to avoid more detailed inspection they may use commonly open ports such as tcp 80 http tcp 443 https tcp 25 smtp tcp udp 53 dns they may use the protocol associated with the port or a completely different protocol ,Commonly Used Port
if network traffic between the mobile device and remote servers is unencrypted or is encrypted in an insecure manner then an adversary positioned on the network can eavesdrop on communication citation mhealth ,Eavesdrop on Insecure Network Communication
adversaries may collect data within notifications sent by the operating system or other applications notifications may contain sensitive data such as one time authentication codes sent over sms email or other mediums in the case of credential access adversaries may attempt to intercept one time code sent to the device adversaries can also dismiss notifications to prevent the user from noticing that the notification has arrived and can trigger action buttons contained within notifications citation eset 2fa bypass ,Access Notifications
an adversary may capture network traffic to and from the device to obtain credentials or other sensitive data or redirect network traffic to flow through an adversary controlled gateway to do the same a malicious app could register itself as a vpn client on android or ios to gain access to network packets however on both platforms the user must grant consent to the app to act as a vpn client and on ios the app requires a special entitlement that must be granted by apple alternatively if a malicious app is able to escalate operating system privileges it may be able to use those privileges to gain access to network traffic an adversary could redirect network traffic to an adversary controlled gateway by establishing a vpn connection or by manipulating the device s proxy settings for example skycure citation skycure profiles describes the ability to redirect network traffic by installing a malicious ios configuration profile if applications encrypt their network traffic sensitive data may not be accessible to an adversary depending on the point of capture ,Network Traffic Capture or Redirection
the operating system and installed applications often have legitimate needs to prompt the user for sensitive information such as account credentials bank account information or personally identifiable information pii adversaries may mimic this functionality to prompt users for sensitive information compared to traditional pcs the constrained display size of mobile devices may impair the ability to provide users with contextual information making users more susceptible to this technique s use citation felt phishingonmobiledevices specific approaches to this technique include impersonate the identity of a legitimate application a malicious application could impersonate the identity of a legitimate application e g use the same application name and or icon and get installed on the device the malicious app could then prompt the user for sensitive information citation eset finance display a prompt on top of a running legitimate application a malicious application could display a prompt on top of a running legitimate application to trick users into entering sensitive information into the malicious application rather than the legitimate application typically the malicious application would need to know when the targeted application and individual activity within the targeted application is running in the foreground so that the malicious application knows when to display its prompt android 5 0 and 5 1 1 respectively increased the difficulty of determining the current foreground application through modifications to the activitymanager api citation android getrunningtasks citation stackoverflow getrunningappprocesses a malicious application can still abuse android s accessibility features to determine which application is currently in the foreground citation threatfabric cerberus approaches to display a prompt include a malicious application could start a new activity on top of a running legitimate application citation felt phishingonmobiledevices citation hassell exploitingandroid android 10 places new restrictions on the ability for an application to start a new activity on top of another application which may make it more difficult for adversaries to utilize this technique citation android background a malicious application could create an application overlay window on top of a running legitimate application applications must hold the system_alert_window permission to create overlay windows this permission is handled differently than typical android permissions and at least under certain conditions is automatically granted to applications installed from the google play store citation cloak and dagger citation nowsecure android overlay citation skycure accessibility the system_alert_window permission and its associated ability to create application overlay windows are expected to be deprecated in a future release of android in favor of a new api citation xda bubbles fake device notifications a malicious application could send fake device notifications to the user clicking on the device notification could trigger the malicious application to display an input prompt citation group ib gustuff mar 2019 ,Input Prompt
adversaries may steal data by exfiltrating it over a different protocol than that of the existing command and control channel the data may also be sent to an alternate network location from the main command and control server alternate protocols include ftp smtp http s dns smb or any other network protocol not being used as the main command and control channel different protocol channels could also include web services such as cloud storage adversaries may opt to also encrypt and or obfuscate these alternate channels ,Exfiltration Over Alternative Protocol
adversaries may check for internet connectivity on compromised systems this may be performed during automated discovery and can be accomplished in numerous ways such as using adb shell netstat for android citation adb_commands adversaries may use the results and responses from these requests to determine if the mobile devices are capable of communicating with adversary owned c2 servers before attempting to connect to them the results may also be used to identify routes redirectors and proxy servers ,Internet Connection Discovery
,Biometric Spoofing
adversaries may use scripts automatically executed at boot or logon initialization to establish persistence initialization scripts are part of the underlying operating system and are not accessible to the user unless the device has been rooted or jailbroken ,Boot or Logon Initialization Scripts
adversaries may use execution guardrails to constrain execution or actions based on adversary supplied and environment specific conditions that are expected to be present on the target guardrails ensure that a payload only executes against an intended target and reduces collateral damage from an adversary s campaign values an adversary can provide about a target system or environment to use as guardrails may include environment information such as location citation swb exodus march 2019 guardrails can be used to prevent exposure of capabilities in environments that are not intended to be compromised or operated within this use of guardrails is distinct from typical system checks https attack mitre org techniques t1633 001 while use of system checks https attack mitre org techniques t1633 001 may involve checking for known sandbox values and continuing with execution only if there is no match the use of guardrails will involve checking for an expected target specific value and only continuing with execution if there is such a match ,Execution Guardrails
adversaries may mimic common operating system gui components to prompt users for sensitive information with a seemingly legitimate prompt the operating system and installed applications often have legitimate needs to prompt the user for sensitive information such as account credentials bank account information or personally identifiable information pii compared to traditional pcs the constrained display size of mobile devices may impair the ability to provide users with contextual information making users more susceptible to this technique s use citation felt phishingonmobiledevices there are several approaches adversaries may use to mimic this functionality adversaries may impersonate the identity of a legitimate application e g use the same application name and or icon and when installed on the device may prompt the user for sensitive information citation eset finance adversaries may also send fake device notifications to the user that may trigger the display of an input prompt when clicked citation group ib gustuff mar 2019 additionally adversaries may display a prompt on top of a running legitimate application to trick users into entering sensitive information into a malicious application rather than the legitimate application typically adversaries need to know when the targeted application and the individual activity within the targeted application is running in the foreground to display the prompt at the proper time adversaries can abuse android s accessibility features to determine which application is currently in the foreground citation threatfabric cerberus two known approaches to displaying a prompt include adversaries start a new activity on top of a running legitimate application citation felt phishingonmobiledevices citation hassell exploitingandroid android 10 places new restrictions on the ability for an application to start a new activity on top of another application which may make it more difficult for adversaries to utilize this technique citation android background adversaries create an application overlay window on top of a running legitimate application applications must hold the system_alert_window permission to create overlay windows this permission is handled differently than typical android permissions and at least under certain conditions is automatically granted to applications installed from the google play store citation cloak and dagger citation nowsecure android overlay citation skycure accessibility the system_alert_window permission and its associated ability to create application overlay windows are expected to be deprecated in a future release of android in favor of a new api citation xda bubbles ,GUI Input Capture
an adversary could call standard operating system apis from a malicious application to gather contact list i e address book data or with escalated privileges could directly access files containing contact list data ,Access Contact List
adversaries may modify system software binaries to establish persistent access to devices system software binaries are used by the underlying operating system and users over adb or terminal emulators adversaries may make modifications to client software binaries to carry out malicious tasks when those binaries are executed for example malware may come with a pre compiled malicious binary intended to overwrite the genuine one on the device since these binaries may be routinely executed by the system or user the adversary can leverage this for persistent access to the device ,Compromise Client Software Binary
adversaries may perform software packing to conceal their code software packing is a method of compressing or encrypting an executable packing an executable changes the file signature in an attempt to avoid signature based detection most decompression techniques decompress the executable code in memory utilities used to perform software packing are called packers an example packer is ftt a more comprehensive list of known packers is available but adversaries may create their own packing techniques that do not leave the same artifacts as well known packers to evade defenses ,Software Packing
,Abuse of iOS Enterprise App Signing Key
an adversary could exploit signaling system vulnerabilities to track the location of mobile devices citation engel ss7 citation engel ss7 2008 citation 3gpp security citation positive ss7 citation csric5 wg10 finalreport ,Exploit SS7 to Track Device Location
adversaries may use android s native development kit ndk to write native functions that can achieve execution of binaries or functions like system calls on a traditional desktop operating system native code achieves execution on a lower level than normal android sdk calls the ndk allows developers to write native code in c or c that is compiled directly to machine code avoiding all intermediate languages and steps in compilation that higher level languages like java typically have the java native interface jni is the component that allows java functions in the android app to call functions in a native library citation google ndk getting started adversaries may also choose to use native functions to execute malicious code since native actions are typically much more difficult to analyze than standard non native behaviors citation mitre app vetting effectiveness ,Native API
malicious applications are a common attack vector used by adversaries to gain a presence on mobile devices this technique describes installing a malicious application on targeted mobile devices without involving an authorized app store e g google play store or apple app store adversaries may wish to avoid placing malicious applications in an authorized app store due to increased potential risk of detection or other reasons however mobile devices often are configured to allow application installation only from an authorized app store which would prevent this technique from working delivery methods for the malicious application include spearphishing attachment https attack mitre org techniques t1566 001 including the mobile app package as an attachment to an email message spearphishing link https attack mitre org techniques t1566 002 including a link to the mobile app package within an email text message e g sms imessage hangouts whatsapp etc web site qr code or other means third party app store installed from a third party app store as opposed to an authorized app store that the device implicitly trusts as part of its default behavior which may not apply the same level of scrutiny to apps as applied by an authorized app store citation ibtimes thirdparty citation trendmicro rootingmalware citation trendmicro flappybird some android malware comes with functionality to install additional applications either automatically or when the adversary instructs it to citation android trojan steals paypal 2fa ,Deliver Malicious App via Other Means
an adversary who is able to obtain unauthorized access to or misuse authorized access to cloud services e g google s android device manager or apple icloud s find my iphone or to an emm console could use that access to wipe enrolled devices citation honan hacking ,Remotely Wipe Data Without Authorization
adversaries may exploit software vulnerabilities in client applications to execute code vulnerabilities can exist in software due to insecure coding practices that can lead to unanticipated behavior adversaries may take advantage of certain vulnerabilities through targeted exploitation for the purpose of arbitrary code execution oftentimes the most valuable exploits to an offensive toolkit are those that can be used to obtain code execution on a remote system because they can be used to gain access to that system users will expect to see files related to the applications they commonly used to do work so they are a useful target for exploit research and development because of their high utility adversaries may use device based zero click exploits for code execution these exploits are powerful because there is no user interaction required for code execution sms imessage delivery sms and imessage in ios are common targets through drive by compromise https attack mitre org techniques t1456 phishing https attack mitre org techniques t1660 etc adversaries may use embed malicious links files etc in sms messages or imessages mobile devices may be compromised through one click exploits where the victim must interact with a text message or zero click exploits where no user interaction is required airdrop unique to ios airdrop is a network protocol that allows ios users to transfer files between ios devices before patches from apple were released on ios 13 4 and earlier adversaries may force the apple wireless direct link awdl interface to activate then exploit a buffer overflow to gain access to the device and run as root without interaction from the user ,Exploitation for Client Execution
adversaries may use a compromised device as a proxy server to the internet by utilizing a proxy adversaries hide the true ip address of their c2 server and associated infrastructure from the destination of the network traffic this masquerades an adversary s traffic as legitimate traffic originating from the compromised device which can evade ip based restrictions and alerts on certain services such as bank accounts and social media websites citation threat fabric exobot the most common type of proxy is a socks proxy it can typically be implemented using standard os level apis and 3rd party libraries with no indication to the user on android adversaries can use the proxy api to programmatically establish a socks proxy connection or lower level apis to interact directly with raw sockets ,Proxy Through Victim
adversaries may use domain generation algorithms https attack mitre org techniques t1520 dgas to procedurally generate domain names for command and control communication and other uses such as malicious application distribution citation securelist rotexy 2018 dgas increase the difficulty for defenders to block track or take over the command and control channel as there potentially could be thousands of domains that malware can check for instructions ,Domain Generation Algorithms
an adversary could call standard operating system apis from a malicious application to gather calendar entry data or with escalated privileges could directly access files containing calendar data ,Access Calendar Entries
an adversary could set up unauthorized wi fi access points or compromise existing access points and if the device connects to them carry out network based attacks such as eavesdropping on or modifying network communication citation nist sp800153 citation kaspersky darkhotel ,Rogue Wi-Fi Access Points
adversaries may abuse android s startforeground api method to maintain continuous sensor access beginning in android 9 idle applications running in the background no longer have access to device sensors such as the camera microphone and gyroscope citation android sensorsoverview applications can retain sensor access by running in the foreground using android s startforeground api method this informs the system that the user is actively interacting with the application and it should not be killed the only requirement to start a foreground service is showing a persistent notification to the user citation android foregroundservices malicious applications may abuse the startforeground api method to continue running in the foreground while presenting a notification to the user pretending to be a genuine application this would allow unhindered access to the device s sensors assuming permission has been previously granted citation blackhat sutter android foreground 2019 malicious applications may also abuse the startforeground api to inform the android system that the user is actively interacting with the application thus preventing it from being killed by the low memory killer citation trendmicro yellow camera ,Foreground Persistence
adversaries may move onto devices by exploiting or copying malware to devices connected via usb in the case of lateral movement adversaries may utilize the physical connection of a device to a compromised or malicious charging station or pc to bypass application store requirements and install malicious applications directly citation lau mactans in the case of initial access adversaries may attempt to exploit the device via the connection to gain access to data stored on the device citation krebs juicejacking examples of this include exploiting insecure bootloaders in a nexus 6 or 6p device over usb and gaining the ability to perform actions including intercepting phone calls intercepting network traffic and obtaining the device physical location citation ibm nexususb exploiting weakly enforced security boundaries in android devices such as the google pixel 2 over usb citation googleprojectzero oatmeal products from cellebrite and grayshift purportedly that can exploit some ios devices using physical access to the data port to unlock the passcode citation computerworld iphonecracking ,Replication Through Removable Media
adversaries may capture audio to collect information by leveraging standard operating system apis of a mobile device examples of audio information adversaries may target include user conversations surroundings phone calls or other sensitive information android and ios by default require that applications request device microphone access from the user on android devices applications must hold the record_audio permission to access the microphone or the capture_audio_output permission to access audio output because android does not allow third party applications to hold the capture_audio_output permission by default only privileged applications such as those distributed by google or the device vendor can access audio output citation android permissions however adversaries may be able to gain this access after successfully elevating their privileges with the capture_audio_output permission adversaries may pass the mediarecorder audiosource voice_call constant to mediarecorder setaudiooutput allowing capture of both voice call uplink and downlink citation manifest permission on ios devices applications must include the nsmicrophoneusagedescription key in their info plist file to access the microphone citation requesting auth media capture ,Audio Capture
adversaries may execute their own malicious payloads by hijacking the way operating systems run applications hijacking execution flow can be for the purposes of persistence since this hijacked execution may reoccur over time there are many ways an adversary may hijack the flow of execution a primary way is by manipulating how the operating system locates programs to be executed how the operating system locates libraries to be used by a program can also be intercepted locations where the operating system looks for programs or resources such as file directories could also be poisoned to include malicious payloads ,Hijack Execution Flow
adversaries may abuse unix shell commands and scripts for execution unix shells are the underlying command prompts on android and ios devices unix shells can control every aspect of a system with certain commands requiring elevated privileges that are only accessible if the device has been rooted or jailbroken unix shells also support scripts that enable sequential execution of commands as well as other typical programming operations such as conditionals and loops common uses of shell scripts include long or repetitive tasks or the need to run the same set of commands on multiple systems adversaries may abuse unix shells to execute various commands or payloads interactive shells may be accessed through command and control channels or during lateral movement such as with ssh adversaries may also leverage shell scripts to deliver and execute multiple commands on victims or as part of payloads used for persistence if the device has been rooted or jailbroken adversaries may locate and invoke a superuser binary to elevate their privileges and interact with the system as the root user this dangerous level of permissions allows the adversary to run special commands and modify protected system files ,Unix Shell
adversaries may communicate using application layer protocols to avoid detection network filtering by blending in with existing traffic commands to the mobile device and often the results of those commands will be embedded within the protocol traffic between the mobile device and server adversaries may utilize many different protocols including those used for web browsing transferring files electronic mail or dns ,Application Layer Protocol
,App Delivered via Web Download
adversaries may download and execute dynamic code not included in the original application package after installation this technique is primarily used to evade static analysis checks and pre publication scans in official app stores in some cases more advanced dynamic or behavioral analysis techniques could detect this behavior however in conjunction with execution guardrails https attack mitre org techniques t1627 techniques detecting malicious code downloaded after installation could be difficult on android dynamic code could include native code dalvik code or javascript code that utilizes android webview s javascriptinterface capability on ios dynamic code could be downloaded and executed through 3rd party libraries such as jspatch citation fireeye jspatch ,Download New Code at Runtime
adversaries may exploit software vulnerabilities to gain initial access to a mobile device this can be accomplished in a variety of ways vulnerabilities may be present in applications services the underlying operating system or in the kernel itself several well known mobile device exploits exist including forcedentry stagefright and blueborne further some exploits may be possible to exploit without any user interaction zero click making them particularly dangerous mobile operating system vendors are typically very quick to patch such critical bugs ensuring only a small window where they can be exploited ,Exploitation for Initial Access
an adversary who is able to obtain unauthorized access to or misuse authorized access to cloud services e g google s android device manager or apple icloud s find my iphone or to an enterprise mobility management emm mobile device management mdm server console could use that access to track mobile devices citation krebs location ,Remotely Track Device Without Authorization
adversaries may employ various system checks to detect and avoid virtualization and analysis environments this may include changing behavior after checking for the presence of artifacts indicative of a virtual environment or sandbox if the adversary detects a virtual environment they may alter their malware s behavior to disengage from the victim or conceal the core functions of the implant they may also search for virtualization artifacts before dropping secondary or additional payloads checks could include generic system properties such as host domain name and samples of network traffic adversaries may also check the network adapters addresses cpu core count and available memory drive size hardware checks such as the presence of motion sensors could also be used to gather evidence that can be indicative a virtual environment adversaries may also query for specific readings from these devices ,System Checks
adversaries may try to access and collect application data resident on the device adversaries often target popular applications such as facebook wechat and gmail citation swb exodus march 2019 due to mobile os sandboxing this technique is only possible in three scenarios an application stores files in unprotected external storage an application stores files in its internal storage directory with insecure permissions e g 777 the adversary gains root permissions on the device ,Stored Application Data
adversaries may use screen capture to collect additional information about a target device such as applications running in the foreground user data credentials or other sensitive information applications running in the background can capture screenshots or videos of another application running in the foreground by using the android mediaprojectionmanager generally requires the device user to grant consent citation fortinet screencap july 2019 citation android screencap1 2019 background applications can also use android accessibility services to capture screen contents being displayed by a foreground application citation lookout monokle an adversary with root access or android debug bridge adb access could call the android screencap or screenrecord commands citation android screencap2 2019 citation trend micro screencap july 2015 ,Screen Capture
adversaries may alter data en route to storage or other systems in order to manipulate external outcomes or hide activity by manipulating transmitted data adversaries may attempt to affect a business process organizational understanding or decision making manipulation may be possible over a network connection or between system processes where there is an opportunity to deploy a tool that will intercept and change information the type of modification and the impact it will have depends on the target transmission mechanism as well as the goals and objectives of the adversary for complex systems an adversary would likely need special expertise and possibly access to specialized software related to the system typically gained through a prolonged information gathering campaign in order to have the desired impact one method to achieve transmitted data manipulation https attack mitre org techniques t1641 001 is by modifying the contents of the device clipboard malicious applications may monitor clipboard activity through the clipboardmanager onprimaryclipchangedlistener interface on android to determine when clipboard contents have changed listening to clipboard activity reading clipboard contents and modifying clipboard contents requires no explicit application permissions and can be performed by applications running in the background however this behavior has changed with the release of android 10 adversaries may use transmitted data manipulation https attack mitre org techniques t1641 001 to replace text prior to being pasted for example replacing a copied bitcoin wallet address with a wallet address that is under adversarial control transmitted data manipulation https attack mitre org techniques t1641 001 was seen within the android clipper c trojan this sample was detected by eset in an application distributed through the google play store targeting cryptocurrency wallet numbers citation eset clipboard modification february 2019 ,Transmitted Data Manipulation
an adversary could use access to a compromised device s credentials to attempt to manipulate app store rankings or ratings by triggering application downloads or posting fake reviews of applications this technique likely requires privileged access a rooted or jailbroken device ,Manipulate App Store Rankings or Ratings
adversaries may register uniform resource identifiers uris to intercept sensitive data applications regularly register uris with the operating system to act as a response handler for various actions such as logging into an app using an external account via single sign on this allows redirections to that specific uri to be intercepted by the application if a malicious application were to register for a uri that was already in use by a genuine application the malicious application may be able to intercept data intended for the genuine application or perform a phishing attack against the genuine application intercepted data may include oauth authorization codes or tokens that could be used by the malicious application to gain access to resources citation trend micro ios url hijacking citation ietf pkce ,URI Hijacking
adversaries may manipulate products or product delivery mechanisms prior to receipt by a final consumer for the purpose of data or system compromise applications often depend on external software to function properly popular open source projects that are used as dependencies in many applications may be targeted as a means to add malicious code to users of the dependency citation grace advertisement ,Compromise Software Dependencies and Development Tools
malicious applications may attempt to detect their operating environment prior to fully executing their payloads these checks are often used to ensure the application is not running within an analysis environment such as a sandbox used for application vetting security research or reverse engineering adversaries may use many different checks such as physical sensors location and system properties to fingerprint emulators and sandbox environments citation talos gustuff apr 2019 citation threatfabric cerberus citation xiao zerghelper citation cyberscoop evade analysis january 2019 adversaries may access android os systemproperties via java reflection to obtain specific system information citation github anti emulator standard values such as phone number imei imsi device ids and device drivers may be checked against default signatures of common sandboxes citation sophos anti emulation ,Evade Analysis Environment
adversaries may register uniform resource identifiers uris to intercept sensitive data applications regularly register uris with the operating system to act as a response handler for various actions such as logging into an app using an external account via single sign on this allows redirections to that specific uri to be intercepted by the application if an adversary were to register for a uri that was already in use by a genuine application the adversary may be able to intercept data intended for the genuine application or perform a phishing attack against the genuine application intercepted data may include oauth authorization codes or tokens that could be used by the adversary to gain access to protected resources citation trend micro ios url hijacking citation ietf pkce ,URI Hijacking
adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted applications operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust examples of such features include an app being allowed to run because it is signed by a valid code signing certificate an os prompt alerting the user that an app came from an untrusted source or getting an indication that you are about to connect to an untrusted site the method adversaries use will depend on the specific mechanism they seek to subvert ,Subvert Trust Controls
on android an adversary could call standard operating system apis from a malicious application to gather call log data or with escalated privileges could directly access files containing call log data on ios applications do not have access to the call log so privilege escalation would be required in order to access the data ,Access Call Log
adversaries may use a device s geographical location to limit certain malicious behaviors for example malware operators may limit the distribution of a second stage payload to certain geographic regions citation lookout esurv geofencing https attack mitre org techniques t1581 is accomplished by persuading the user to grant the application permission to access location services the application can then collect process and exfiltrate the device s location to perform location based actions such as ceasing malicious behavior or showing region specific advertisements one method to accomplish geofencing https attack mitre org techniques t1581 on android is to use the built in geofencing api to automatically trigger certain behaviors when the device enters or exits a specified radius around a geographical location similar to other geofencing https attack mitre org techniques t1581 methods this requires that the user has granted the access_fine_location and access_background_location permissions the latter is only required if the application targets android 10 api level 29 or higher however android 11 introduced additional permission controls that may restrict background location collection based on user permission choices at runtime these additional controls include allow only while using the app which will effectively prohibit background location collection citation android geofencing api similarly on ios developers can use built in apis to setup and execute geofencing depending on the use case the app will either need to call requestwheninuseauthorization or requestalwaysauthorization depending on when access to the location services is required similar to android users also have the option to limit when the application can access the device s location including one time use and only when the application is running in the foreground citation apple location services geofencing https attack mitre org techniques t1581 can be used to prevent exposure of capabilities in environments that are not intended to be compromised or operated within for example location data could be used to limit malware spread and or capabilities which could also potentially evade application analysis environments ex malware analysis outside of the target geographic area other malicious usages could include showing language specific input prompt https attack mitre org techniques t1411 s and or advertisements ,Geofencing
adversaries may request device administrator permissions to perform malicious actions by abusing the device administration api adversaries can perform several nefarious actions such as resetting the device s password for device lockout https attack mitre org techniques t1446 factory resetting the device to delete device data https attack mitre org techniques t1447 and any traces of the malware disabling all of the device s cameras or make it more difficult to uninstall the app citation android deviceadmininfo device administrators must be approved by the user at runtime with a system popup showing which of the actions have been requested by the app in conjunction with other techniques such as input injection https attack mitre org techniques t1516 an app can programmatically grant itself administrator permissions without any user input ,Device Administrator Permissions
,Remotely Install Application
adversaries may collect keychain data from an ios device to acquire credentials keychains are the built in way for ios to keep track of users passwords and credentials for many services and features such as wi fi passwords websites secure notes certificates private keys and vpn credentials on the device the keychain database is stored outside of application sandboxes to prevent unauthorized access to the raw data standard ios apis allow applications access to their own keychain contained within the database by utilizing a privilege escalation exploit or existing root access adversaries can access the entire encrypted database citation apple keychain services citation elcomsoft decrypt keychain ,Keychain
art the android runtime compiles optimized code on the device itself to improve performance an adversary may be able to use escalated privileges to modify the cached code in order to hide malicious behavior since the code is compiled on the device it may not receive the same level of integrity checks that are provided to code running in the system partition citation sabanal art ,Modify Cached Executable Code
on android device type information is accessible to apps through the android os build class citation android build device information could be used to target privilege escalation exploits ,Device Type Discovery
adversaries may include functionality in malware that uninstalls the malicious application from the device this can be achieved by abusing device owner permissions to perform silent uninstallation using device owner api calls abusing root permissions to delete files from the filesystem abusing the accessibility service this requires an intent be sent to the system to request uninstallation and then abusing the accessibility service to click the proper places on the screen to confirm uninstallation ,Uninstall Malicious Application
adversaries may wipe a device or delete individual files in order to manipulate external outcomes or hide activity an application must have administrator access to fully wipe the device while individual files may not require special permissions to delete depending on their storage location citation android devicepolicymanager 2019 stored data could include a variety of file formats such as office files databases stored emails and custom file formats the impact file deletion will have depends on the type of data as well as the goals and objectives of the adversary but can include deleting update files to evade detection or deleting attacker specified files for impact ,Delete Device Data
a malicious app may trigger fraudulent charges on a victim s carrier billing statement in several different ways including sms toll fraud and sms shortcodes that make purchases performing sms fraud relies heavily upon the fact that when making sms purchases the carriers perform device verification but not user verification this allows adversaries to make purchases on behalf of the user with little or no user interaction citation google bread malicious applications may also perform toll billing which occurs when carriers provide payment endpoints over a web page the application connects to the web page over cellular data so the carrier can directly verify the number or the application must retrieve a code sent via sms and enter it into the web page citation google bread on ios apps cannot send sms messages on android apps must hold the send_sms permission to send sms messages additionally android version 4 2 and above has mitigations against this threat by requiring user consent before allowing sms messages to be sent to premium numbers citation androidsecurity2014 ,Carrier Billing Fraud
an ios application may be able to maliciously claim a url scheme allowing it to intercept calls that are meant for a different application citation fireeye masque2 citation dhanjani urlscheme this technique for example could be used to capture oauth authorization codes citation ietf pkce or to phish user credentials citation mobileiron xara ,URL Scheme Hijacking
adversaries may use an existing legitimate external web service channel as a means for sending commands to and receiving output from a compromised system compromised systems may leverage popular websites and social media to host command and control c2 instructions those infected systems can then send the output from those commands back over that web service channel the return traffic may occur in a variety of ways depending on the web service being utilized for example the return traffic may take the form of the compromised system posting a comment on a forum issuing a pull request to development project updating a document hosted on a web service or by sending a tweet popular websites and social media acting as a mechanism for c2 may give a significant amount of cover this is due to the likelihood that hosts within a network are already communicating with them prior to a compromise using common services such as those offered by google or twitter makes it easier for adversaries to hide in expected noise web service providers commonly use ssl tls encryption giving adversaries an added level of protection ,Bidirectional Communication
adversaries may generate network traffic using a protocol and port pairing that are typically not associated for example https over port 8088 or port 587 as opposed to the traditional port 443 adversaries may make changes to the standard port used by a protocol to bypass filtering or muddle analysis parsing of network data ,Non-Standard Port
adversaries may manipulate application software prior to receipt by a final consumer for the purpose of data or system compromise supply chain compromise of software can take place in a number of ways including manipulation of the application source code manipulation of the update distribution mechanism for that software or replacing compiled releases with a modified version ,Compromise Software Supply Chain
adversaries may use an existing legitimate external web service to host information that points to additional command and control c2 infrastructure adversaries may post content known as a dead drop resolver on web services with embedded and often obfuscated encoded domains or ip addresses once infected victims will reach out to and be redirected by these resolvers popular websites and social media acting as a mechanism for c2 may give a significant amount of cover this is due to the likelihood that hosts within a network are already communicating with them prior to a compromise using common services such as those offered by google or twitter makes it easier for adversaries to hide in expected noise web service providers commonly use ssl tls encryption giving adversaries an added level of protection use of a dead drop resolver may also protect back end c2 infrastructure from discovery through malware binary analysis or enable operational resiliency since this infrastructure may be dynamically changed ,Dead Drop Resolver
adversaries may track a device s physical location through use of standard operating system apis via malicious or exploited applications on the compromised device on android applications holding the access_coaurse_location or access_fine_location permissions provide access to the device s physical location on android 10 and up declaration of the access_background_location permission in an application s manifest will allow applications to request location access even when the application is running in the background citation android request location permissions some adversaries have utilized integration of baidu map services to retrieve geographical location once the location access permissions had been obtained citation paloalto spydealer citation palo alto henbox on ios applications must include the nslocationwheninuseusagedescription nslocationalwaysandwheninuseusagedescription and or nslocationalwaysusagedescription keys in their info plist file depending on the extent of requested access to location information citation apple requesting authorization for location services on ios 8 0 and up applications call requestwheninuseauthorization to request access to location information when the application is in use or requestalwaysauthorization to request access to location information regardless of whether the application is in use with elevated privileges an adversary may be able to access location data without explicit user consent with the com apple locationd preauthorized entitlement key citation google project zero insomnia ,Location Tracking
adversaries may abuse android s device administration api to obtain a higher degree of control over the device by abusing the api adversaries can perform several nefarious actions such as resetting the device s password for endpoint denial of service https attack mitre org techniques t1642 factory resetting the device for file deletion https attack mitre org techniques t1630 002 and to delete any traces of the malware disabling all the device s cameras or to make it more difficult to uninstall the app device administrators must be approved by the user at runtime with a system popup showing which actions have been requested by the app in conjunction with other techniques such as input injection https attack mitre org techniques t1516 an app can programmatically grant itself administrator permissions without any user input ,Device Administrator Permissions
an adversary may seek to lock the legitimate user out of the device for example to inhibit user interaction or to obtain a ransom payment on android versions prior to 7 apps can abuse device administrator access to reset the device lock passcode to prevent the user from unlocking the device after android 7 only device or profile owners e g mdms can reset the device s passcode citation android resetpassword on ios devices this technique does not work because mobile device management servers can only remove the screen lock passcode they cannot set a new passcode however on jailbroken devices malware has been discovered that can lock the user out of the device citation xiao keyraider ,Device Lockout
an adversary may use access to cloud services e g google s android device manager or apple icloud s find my iphone or to an enterprise mobility management emm mobile device management mdm server console to track the location of mobile devices managed by the service citation krebs location ,Remote Device Management Services
adversaries may destroy data and files on specific devices or in large numbers to interrupt availability to systems services and network resources data destruction is likely to render stored data irrecoverable by forensic techniques through overwriting files or data on local and remote drives to achieve data destruction adversaries may use the pm uninstall command to uninstall packages or the rm command to remove specific files for example adversaries may first use pm uninstall to uninstall non system apps and then use rm f file s to delete specific files further hiding malicious activity citation rootnik_rooting_tool citation abuse_native_linux_tools ,Data Destruction
with escalated privileges an adversary could program the mobile device to impersonate usb devices such as input devices keyboard and mouse storage devices and or networking devices in order to attack a physically connected pc citation wang exploitingusb citation arstechnica poisontap this technique has been demonstrated on android we are unaware of any demonstrations on ios ,Attack PC via USB Connection
,Stolen Developer Credentials or Signing Keys
an adversary could set up a rogue cellular base station and then use it to eavesdrop on or manipulate cellular device communication a compromised cellular femtocell could be used to carry out this technique citation computerworld femtocell ,Rogue Cellular Base Station
an adversary could convince the mobile network operator e g through social networking forged identification or insider attacks performed by trusted employees to issue a new sim card and associate it with an existing phone number and account citation nygov simswap citation motherboard simswap2 the adversary could then obtain sms messages or hijack phone calls intended for someone else citation betanews simswap one use case is intercepting authentication messages or phone calls to obtain illicit access to online banking or other online accounts as many online services allow account password resets by sending an authentication code over sms to a phone number associated with the account citation guardian simswap citation motherboard simswap1 citation krebs simswap citation techcrunch simswap ,SIM Card Swap
adversaries may use methods of capturing user input to obtain credentials or collect information during normal device usage users often provide credentials to various locations such as login pages portals or system dialog boxes input capture mechanisms may be transparent to the user e g keylogging https attack mitre org techniques t1417 001 or rely on deceiving the user into providing input into what they believe to be a genuine application prompt e g gui input capture https attack mitre org techniques t1417 002 ,Input Capture
adversaries may generate outbound traffic from devices this is typically performed to manipulate external outcomes such as to achieve carrier billing fraud or to manipulate app store rankings or ratings outbound traffic is typically generated as sms messages or general web traffic but may take other forms as well if done via sms messages android apps must hold the send_sms permission additionally sending an sms message requires user consent if the recipient is a premium number applications cannot send sms messages on ios,Generate Traffic from Victim
an adversary could use knowledge of the techniques used by security software to evade detection citation brodie citation tan for example some mobile security products perform compromised device detection by searching for particular artifacts such as an installed su binary but that check could be evaded by naming the binary something else similarly polymorphic code techniques could be used to evade signature based detection citation rastogi ,Disguise Root/Jailbreak Indicators
an adversary could distribute developed malware by masquerading the malware as a legitimate application this can be done in two different ways by embedding the malware in a legitimate application or by pretending to be a legitimate application embedding the malware in a legitimate application is done by downloading the application disassembling it adding the malicious code and then re assembling it citation zhou the app would appear to be the original app but would contain additional malicious functionality the adversary could then publish the malicious application to app stores or use another delivery method pretending to be a legitimate application relies heavily on lack of scrutinization by the user typically a malicious app pretending to be a legitimate one will have many similar details as the legitimate one such as name icon and description citation palo alto henbox malicious applications may also masquerade as legitimate applications when requesting access to the accessibility service in order to appear as legitimate to the user increasing the likelihood that the access will be granted ,Masquerade as Legitimate Application
,Malicious Media Content
adversaries may utilize standard operating system apis to gather calendar entry data on android this can be accomplished using the calendar content provider on ios this can be accomplished using the eventkit framework if the device has been jailbroken or rooted an adversary may be able to access calendar entries https attack mitre org techniques t1636 001 without the user s knowledge or approval ,Calendar Entries
adversaries may wipe a device or delete individual files in order to manipulate external outcomes or hide activity an application must have administrator access to fully wipe the device while individual files may not require special permissions to delete depending on their storage location citation android devicepolicymanager 2019 stored data could include a variety of file formats such as office files databases stored emails and custom file formats the impact file deletion will have depends on the type of data as well as the goals and objectives of the adversary but can include deleting update files to evade detection or deleting attacker specified files for impact ,File Deletion
an adversary may seek to inhibit user interaction by locking the legitimate user out of the device this is typically accomplished by requesting device administrator permissions and then locking the screen using devicepolicymanager locknow other novel techniques for locking the user out of the device have been observed such as showing a persistent overlay using carefully crafted call notification screens and locking html pages in the foreground these techniques can be very difficult to get around and typically require booting the device into safe mode to uninstall the malware citation microsoft mallockerb citation talos gplayed citation securelist rotexy 2018 prior to android 7 device administrators were able to reset the device lock passcode to prevent the user from unlocking the device the release of android 7 introduced updates that only allow device or profile owners e g mdms to reset the device s passcode citation android resetpassword ,Device Lockout
adversaries may log user keystrokes to intercept credentials or other information from the user as the user types them some methods of keylogging include masquerading as a legitimate third party keyboard to record user keystrokes citation zeltser keyboard on both android and ios users must explicitly authorize the use of third party keyboard apps users should be advised to use extreme caution before granting this authorization when it is requested abusing accessibility features on android adversaries may abuse accessibility features to record keystrokes by registering an accessibilityservice class overriding the onaccessibilityevent method and listening for the accessibilityevent type_view_text_changed event type the event object passed into the function will contain the data that the user typed additional methods of keylogging may be possible if root access is available ,Keylogging
adversaries may delete alter or send sms messages without user authorization this could be used to hide c2 sms messages spread malware or various external effects this can be accomplished by requesting the receive_sms or send_sms permissions depending on what the malware is attempting to do if the app is set as the default sms handler on the device the sms_deliver broadcast intent can be registered which allows the app to write to the sms content provider the content provider directly modifies the messaging database on the device which could allow malicious applications with this ability to insert modify or delete arbitrary messages on the device citation sms kitkat citation android smsprovider ,SMS Control
an adversary could use knowledge of the techniques used by security software to evade detection citation brodie citation tan for example some mobile security products perform compromised device detection by searching for particular artifacts such as an installed su binary but that check could be evaded by naming the binary something else similarly polymorphic code techniques could be used to evade signature based detection citation rastogi ,Disguise Root/Jailbreak Indicators
adversaries may attempt to exfiltrate data over a different network medium than the command and control channel if the command and control network is a standard internet connection the exfiltration may occur for example via bluetooth or another radio frequency rf channel adversaries may choose to do this if they have sufficient access or proximity and the connection might not be secured or defended as well as the primary internet connected channel because it is not routed through the same enterprise network ,Exfiltration Over Other Network Medium
,Detect App Analysis Environment
adversaries may inject code into processes in order to evade process based defenses or even elevate privileges process injection is a method of executing arbitrary code in the address space of a separate live process running code in the context of another process may allow access to the process s memory system network resources and possibly elevated privileges execution via process injection may also evade detection from security products since the execution is masked under a legitimate process both android and ios have no legitimate way to achieve process injection the only way this is possible is by abusing existing root access or exploiting a vulnerability ,Process Injection
,Malicious Software Development Tools
adversaries may employ a known symmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol symmetric encryption algorithms use the same key for plaintext encryption and ciphertext decryption common symmetric encryption algorithms include aes blowfish and rc4 ,Symmetric Cryptography
an intent is a message passed between android application or system components applications can register to receive broadcast intents at runtime which are system wide intents delivered to each app when certain events happen on the device such as network changes or the user unlocking the screen malicious applications can then trigger certain actions within the app based on which broadcast intent was received further malicious applications can register for intents broadcasted by other applications in addition to the android system itself this allows the malware to respond based on actions in other applications this behavior typically indicates a more intimate knowledge or potentially the targeting of specific devices users or applications in android 8 api level 26 broadcast intent behavior was changed limiting the implicit intents that applications can register for in the manifest in most cases applications that register through the manifest will no longer receive the broadcasts now applications must register context specific broadcast receivers while the user is actively using the app citation android changes to system broadcasts ,Broadcast Receivers
adversaries may search for information about wi fi networks such as network names and passwords on compromised systems adversaries may use wi fi information as part of discovery https attack mitre org tactics ta0032 or credential access https attack mitre org tactics ta0031 activity to support both ongoing and future campaigns ,Wi-Fi Discovery
adversaries may manipulate hardware components in products prior to receipt by a final consumer for the purpose of data or system compromise by modifying hardware or firmware in the supply chain adversaries can insert a backdoor into consumer networks that may be difficult to detect and give the adversary a high degree of control over the system ,Compromise Hardware Supply Chain
adversaries may abuse clipboard manager apis to obtain sensitive information copied to the device clipboard for example passwords being copied and pasted from a password manager application could be captured by a malicious application installed on the device citation fahl clipboard on android applications can use the clipboardmanager onprimaryclipchangedlistener api to register as a listener and monitor the clipboard for changes however starting in android 10 this can only be used if the application is in the foreground or is set as the device s default input method editor ime citation github capture clipboard 2019 citation android 10 privacy changes on ios this can be accomplished by accessing the uipasteboard general string field however starting in ios 14 upon accessing the clipboard the user will be shown a system notification if the accessed text originated in a different application for example if the user copies the text of an imessage from the messages application the notification will read application_name has pasted from messages when the text was pasted in a different application citation uippasteboard ,Clipboard Data
if an adversary can escalate privileges he or she may be able to use those privileges to place malicious code in the device system partition where it may persist after device resets and may not be easily removed by the device user many android devices provide the ability to unlock the bootloader for development purposes an unlocked bootloader may provide the ability for an adversary to modify the system partition even if the bootloader is locked it may be possible for an adversary to escalate privileges and then modify the system partition ,Modify System Partition
adversaries may insert delete or alter data in order to manipulate external outcomes or hide activity by manipulating data adversaries may attempt to affect a business process organizational understanding or decision making the type of modification and the impact it will have depends on the target application process and the goals and objectives of the adversary for complex systems an adversary would likely need special expertise and possibly access to specialized software related to the system typically gained through a prolonged information gathering campaign in order to have the desired impact ,Data Manipulation
adversaries may utilize standard operating system apis to gather sms messages on android this can be accomplished using the sms content provider ios provides no standard api to access sms messages if the device has been jailbroken or rooted an adversary may be able to access sms messages https attack mitre org techniques t1636 004 without the user s knowledge or approval ,SMS Messages
adversaries may use an existing legitimate external web service as a means for relaying data to from a compromised system popular websites and social media acting as a mechanism for c2 may give a significant amount of cover this is due to the likelihood that hosts within a network are already communicating with them prior to a compromise using common services such as those offered by google or twitter makes it easier for adversaries to hide in expected noise web service providers commonly use ssl tls encryption giving adversaries an added level of protection use of web services may also protect back end c2 infrastructure from discovery through malware binary analysis or enable operational resiliency since this infrastructure may be dynamically changed ,Web Service
adversaries may execute their own malicious payloads by hijacking the way an operating system runs applications hijacking execution flow can be for the purposes of persistence since this hijacked execution may reoccur at later points in time on android adversaries may overwrite the standard os api library with a malicious alternative to hook into core functions to achieve persistence by doing this the adversary s code will be executed every time the overwritten api function is called by an app on the infected device ,System Runtime API Hijacking
,Exploit Baseband Vulnerability
adversaries may search common password storage locations to obtain user credentials passwords can be stored in several places on a device depending on the operating system or application holding the credentials there are also specific applications that store passwords to make it easier for users to manage and maintain once credentials are obtained they can be used to perform lateral movement and access restricted information ,Credentials from Password Store
adversaries may utilize hooking to hide the presence of artifacts associated with their behaviors to evade detection hooking can be used to modify return values or data structures of system apis and function calls this process typically involves using 3rd party root frameworks such as xposed or magisk with either a system exploit or pre existing root access by including custom modules for root frameworks adversaries can hook system apis and alter the return value and or system data structures to alter functionality visibility of various aspects of the system ,Hooking
an adversary could attempt to install insecure or malicious configuration settings on the mobile device through means such as phishing emails or text messages either directly containing the configuration settings as an attachment or containing a web link to the configuration settings the device user may be tricked into installing the configuration settings through social engineering techniques citation symantec iosprofile for example an unwanted certification authority ca certificate could be placed in the device s trusted certificate store increasing the device s susceptibility to adversary in the middle network attacks seeking to eavesdrop on or manipulate the device s network communication eavesdrop on insecure network communication https attack mitre org techniques t1439 and manipulate device communication https attack mitre org techniques t1463 on ios malicious configuration profiles could contain unwanted certification authority ca certificates or other insecure settings such as unwanted proxy server or vpn settings to route the device s network traffic through an adversary s system the device could also potentially be enrolled into a malicious mobile device management mdm system citation talos mdm ,Install Insecure or Malicious Configuration
adversaries may enumerate files and directories or search in specific device locations for desired information within a filesystem adversaries may use the information from file and directory discovery https attack mitre org techniques t1420 during automated discovery to shape follow on behaviors including deciding if the adversary should fully infect the target and or attempt specific actions on android linux file permissions and selinux policies typically stringently restrict what can be accessed by apps without taking advantage of a privilege escalation exploit the contents of the external storage directory are generally visible which could present concerns if sensitive data is inappropriately stored there ios s security architecture generally restricts the ability to perform any type of file and directory discovery https attack mitre org techniques t1420 without use of escalated privileges ,File and Directory Discovery
adversaries may attempt to make a payload or file difficult to discover or analyze by encrypting encoding or otherwise obfuscating its contents on the device or in transit this is common behavior that can be used across different platforms and the network to evade defenses payloads may be compressed archived or encrypted in order to avoid detection these payloads may be used during initial access or later to mitigate detection portions of files can also be encoded to hide the plaintext strings that would otherwise help defenders with discovery payloads may also be split into separate seemingly benign files that only reveal malicious functionality when reassembled citation microsoft mallockerb ,Obfuscated Files or Information
a malicious application can inject input to the user interface to mimic user interaction through the abuse of android s accessibility apis input injection https attack mitre org techniques t1516 can be achieved using any of the following methods mimicking user clicks on the screen for example to steal money from a user s paypal account citation android trojan steals paypal 2fa injecting global actions such as global_action_back programatically mimicking a physical back button press to trigger actions on behalf of the user citation talos gustuff apr 2019 inserting input into text fields on behalf of the user this method is used legitimately to auto fill text fields by applications such as password managers citation bitwarden autofill logins ,Input Injection
adversaries may perform network denial of service dos attacks to degrade or block the availability of targeted resources to users network dos can be performed by exhausting the network bandwidth that services rely on or by jamming the signal going to or coming from devices a network dos will occur when an adversary is able to jam radio signals e g wi fi cellular gps around a device to prevent it from communicating for example to jam cellular signal an adversary may use a handheld signal jammer which jam devices within the jammer s operational range citation nist sp800187 usage of cellular jamming has been documented in several arrests reported in the news citation cnet celljammer citation nytimes celljam citation digitaltrends celljam citation arstechnica celljam ,Network Denial of Service
adversaries may modify applications installed on a device to establish persistent access to a victim these malicious modifications can be used to make legitimate applications carry out adversary tasks when these applications are in use there are multiple ways an adversary can inject malicious code into applications one method is by taking advantages of device vulnerabilities the most well known being janus an android vulnerability that allows adversaries to add extra bytes to apk application and dex executable files without affecting the file s signature by being able to add arbitrary bytes to valid applications attackers can seamlessly inject code into genuine executables without the user s knowledge citation guardsquare janus adversaries may also rebuild applications to include malicious modifications this can be achieved by decompiling the genuine application merging it with the malicious code and recompiling it citation checkpoint agent smith adversaries may also take action to conceal modifications to application executables and bypass user consent these actions include altering modifications to appear as an update or exploiting vulnerabilities that allow activities of the malicious application to run inside a system application citation checkpoint agent smith ,Compromise Application Executable
adversaries may establish persistence using system mechanisms that trigger execution based on specific events mobile operating systems have means to subscribe to events such as receiving an sms message device boot completion or other device activities adversaries may abuse these mechanisms as a means of maintaining persistent access to a victim via automatically and repeatedly executing malicious code after gaining access to a victim s system adversaries may create or modify event triggers to point to malicious content that will be executed whenever the event trigger is invoked ,Event Triggered Execution
adversaries may look for details about the network configuration and settings such as ip and or mac addresses of devices they access or through information discovery of remote systems adversaries may use the information from system network configuration discovery https attack mitre org techniques t1422 during automated discovery to shape follow on behaviors including determining certain access within the target network and what actions to do next on android details of onboard network interfaces are accessible to apps through the java net networkinterface class citation networkinterface previously the android telephonymanager class could be used to gather telephony related device identifiers information such as the imsi imei and phone number however starting with android 10 only preloaded carrier the default sms or device and profile owner applications can access the telephony related device identifiers citation telephonymanager on ios gathering network configuration information is not possible without root access adversaries may use the information from system network configuration discovery https attack mitre org techniques t1422 during automated discovery to shape follow on behaviors including determining certain access within the target network and what actions to do next ,System Network Configuration Discovery
if network traffic between the mobile device and a remote server is not securely protected then an attacker positioned on the network may be able to manipulate network communication without being detected for example fireeye researchers found in 2014 that 68 of the top 1 000 free applications in the google play store had at least one transport layer security tls implementation vulnerability potentially opening the applications network traffic to adversary in the middle attacks citation fireeye ssl ,Manipulate Device Communication
an adversary can leverage a device s cameras to gather information by capturing video recordings images may also be captured potentially in specified intervals in lieu of video files malware or scripts may interact with the device cameras through an available api provided by the operating system video or image files may be written to disk and exfiltrated later this technique differs from screen capture https attack mitre org techniques t1513 due to use of the device s cameras for video recording rather than capturing the victim s screen in android an application must hold the android permission camera permission to access the cameras in ios applications must include the nscamerausagedescription key in the info plist file in both cases the user must grant permission to the requesting application to use the camera if the device has been rooted or jailbroken an adversary may be able to access the camera without knowledge of the user ,Video Capture
adversaries may use an existing legitimate external web service channel as a means for sending commands to a compromised system without receiving return output compromised systems may leverage popular websites and social media to host command and control c2 instructions those infected systems may opt to send the output from those commands back over a different c2 channel including to another distinct web service alternatively compromised systems may return no output at all in cases where adversaries want to send instructions to systems and do not want a response popular websites and social media acting as a mechanism for c2 may give a significant amount of cover this is due to the likelihood that hosts within a network are already communicating with them prior to a compromise using common services such as those offered by google or twitter makes it easier for adversaries to hide in expected noise web service providers commonly use ssl tls encryption giving adversaries an added level of protection ,One-Way Communication
malicious applications are a common attack vector used by adversaries to gain a presence on mobile devices mobile devices often are configured to allow application installation only from an authorized app store e g google play store or apple app store an adversary may seek to place a malicious application in an authorized app store enabling the application to be installed onto targeted devices app stores typically require developer registration and use vetting techniques to identify malicious applications adversaries may use these techniques against app store defenses download new code at runtime https attack mitre org techniques t1407 obfuscated files or information https attack mitre org techniques t1406 adversaries may also seek to evade vetting by placing code in a malicious application to detect whether it is running in an app analysis environment and if so avoid performing malicious actions while under analysis citation petsas citation oberheide bouncer citation percoco bouncer citation wang adversaries may also use fake identities payment cards etc to create developer accounts to publish malicious applications to app stores citation oberheide bouncer adversaries may also use control of a target s google account to use the google play store s remote installation capability to install apps onto the android devices associated with the google account citation oberheide remoteinstall citation konoth only applications that are available for download through the google play store can be remotely installed using this technique ,Deliver Malicious App via Authorized App Store
an adversary may encrypt files stored on a mobile device to prevent the user from accessing them this may be done in order to extract monetary compensation from a victim in exchange for decryption or a decryption key ransomware or to render data permanently inaccessible in cases where the key is not saved or transmitted ,Data Encrypted for Impact
adversaries may abuse the android device administration api to prevent the user from uninstalling a target application in earlier versions of android device administrator applications needed their administration capabilities explicitly deactivated by the user before the application could be uninstalled this was later updated so the user could deactivate and uninstall the administrator application in one step adversaries may also abuse the device accessibility apis to prevent removal this set of apis allows the application to perform certain actions on behalf of the user and programmatically determine what is being shown on the screen the malicious application could monitor the device screen for certain modals e g the confirmation modal to uninstall an application and inject screen input or a back button tap to close the modal for example android s performglobalaction int api could be utilized to prevent the user from removing the malicious application from the device after installation if the user wants to uninstall the malicious application two cases may occur both preventing the user from removing the application case 1 if the integer argument passed to the api call is 2 or global_action_home the malicious application may direct the user to the home screen from settings screen case 2 if the integer argument passed to the api call is 1 or global_action_back the malicious application may emulate the back press event ,Prevent Application Removal
adversaries may attempt to get a listing of network connections to or from the compromised device they are currently accessing or from remote systems by querying for information over the network this is typically accomplished by utilizing device apis to collect information about nearby networks such as wi fi bluetooth and cellular tower connections on android this can be done by querying the respective apis wifiinfo for information about the current wi fi connection as well as nearby wi fi networks querying the wifiinfo api requires the application to hold the access_fine_location permission bluetoothadapter for information about bluetooth devices which also requires the application to hold several permissions granted by the user at runtime for android versions prior to q applications can use the telephonymanager getneighboringcellinfo method for q and later applications can use the telephonymanager getallcellinfo method both methods require the application hold the access_fine_location permission ,System Network Connections Discovery
adversaries may send malicious content to users in order to gain access to their mobile devices all forms of phishing are electronically delivered social engineering adversaries can conduct both non targeted phishing such as in mass malware spam campaigns as well as more targeted phishing tailored for a specific individual company or industry known as spearphishing phishing often involves social engineering techniques such as posing as a trusted source as well as evasion techniques such as removing or manipulating emails or metadata headers from compromised accounts being abused to send messages mobile phishing may take various forms for example adversaries may send emails containing malicious attachments or links typically to deliver and then execute malicious code on victim devices phishing may also be conducted via third party services like social media platforms mobile devices are a particularly attractive target for adversaries executing phishing campaigns due to their smaller form factor than traditional desktop endpoints users may not be able to notice minor differences between genuine and phishing websites further mobile devices have additional sensors and radios that allow adversaries to execute phishing attempts over several different vectors such as sms messages adversaries may send sms messages known as smishing from compromised devices to potential targets to convince the target to for example install malware navigate to a specific website or enable certain insecure configurations on their device quick response qr codes adversaries may use qr codes known as quishing to redirect users to a phishing website for example an adversary could replace a legitimate public qr code with one that leads to a different destination such as a phishing website a malicious qr code could also be delivered via other means such as sms or email in the latter case an adversary could utilize a malicious qr code in an email to pivot from the user s desktop computer to their mobile device phone calls adversaries may call victims known as vishing to persuade them to perform an action such as providing login credentials or navigating to a malicious website this could also be used as a technique to perform the initial access on a mobile device but then pivot to a computer other network by having the victim perform an action on a desktop computer ,Phishing
adversaries may use ssl pinning https attack mitre org techniques t1521 003 to protect the c2 traffic from being intercepted and analyzed ssl pinning https attack mitre org techniques t1521 003 is a technique commonly utilized by legitimate websites to ensure that encrypted communications are only allowed with a pre defined certificate if another certificate is presented it could indicate device compromise traffic interception or another upstream issue while benign usages are common it is also possible for adversaries to abuse this technology to protect malicious c2 traffic in normal not pinned ssl validation when a client connects to a server using https it typically checks whether the server s ssl tls certificate is signed by a trusted certificate authority ca in the device s trust store if the certificate is valid and signed by a trusted ca the connection is established however with ssl pinning https attack mitre org techniques t1521 003 the client is configured to trust a specific ssl tls certificate or public key rather than relying on the device s trust store this means that even if the server s certificate is signed by a trusted ca the client will only establish the connection of the certificate or key is pinned there are two types of ssl pinning https attack mitre org techniques t1521 003 1 certificate pinning the client stores a copy of the server s certificate and compares it with the certificate received during the ssl handshake if the certificates match then the client proceeds with the connection this approach also works with self signed certificates 2 public key pinning instead of pinning the entire certificate the client pins just the public key extracted from the certificate this is often more flexible as it allows the server to renew its certificate without having to update the pinned certificate or breaking the ssl connection ,SSL Pinning
an adversary with physical access to a mobile device may seek to bypass the device s lockscreen several methods exist to accomplish this including biometric spoofing if biometric authentication is used an adversary could attempt to spoof a mobile device s biometric authentication mechanism both ios and android partly mitigate this attack by requiring the device s passcode rather than biometrics to unlock the device after every device restart and after a set or random amount of time citation srlabs fingerprint citation thesun faceid unlock code bypass an adversary could attempt to brute force or otherwise guess the lockscreen passcode typically a pin or password including physically observing shoulder surfing the device owner s use of the lockscreen passcode mobile os vendors partly mitigate this by implementing incremental backoff timers after a set number of failed unlock attempts as well as a configurable full device wipe after several failed unlock attempts vulnerability exploit techniques have been periodically demonstrated that exploit mobile devices to bypass the lockscreen the vulnerabilities are generally patched by the device or os vendor once disclosed citation wired androidbypass citation kaspersky iosbypass ,Lockscreen Bypass
adversaries may use built in command line interfaces to interact with the device and execute commands android provides a bash shell that can be interacted with over the android debug bridge adb or programmatically using java s runtime package on ios adversaries can interact with the underlying runtime shell if the device has been jailbroken if the device has been rooted or jailbroken adversaries may locate and invoke a superuser binary to elevate their privileges and interact with the system as the root user this dangerous level of permissions allows the adversary to run special commands and modify protected system files ,Command-Line Interface
adversaries may utilize standard operating system apis to gather contact list data on android this can be accomplished using the contacts content provider on ios this can be accomplished using the contacts framework if the device has been jailbroken or rooted an adversary may be able to access the contact list https attack mitre org techniques t1636 003 without the user s knowledge or approval ,Contact List
adversaries may search local system sources such as file systems or local databases to find files of interest and sensitive data prior to exfiltration access to local system data which includes information stored by the operating system often requires escalated privileges examples of local system data include authentication tokens the device keyboard cache wi fi passwords and photos on android adversaries may also attempt to access files from external storage which may require additional storage related permissions ,Data from Local System
adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users accounts may be deleted locked or manipulated ex credentials changed to remove access to accounts ,Account Access Removal
adversaries may attempt to get detailed information about a device s operating system and hardware including versions patches and architecture adversaries may use the information from system information discovery https attack mitre org techniques t1426 during automated discovery to shape follow on behaviors including whether or not to fully infects the target and or attempts specific actions on android much of this information is programmatically accessible to applications through the android os build class citation android build ios is much more restrictive with what information is visible to applications typically applications will only be able to query the device model and which version of ios it is running ,System Information Discovery
,Fake Developer Accounts
adversaries may abuse clipboard functionality to intercept and replace information in the android device clipboard citation eset clipboard modification february 2019 citation welivesecurity clipboard modification february 2019 citation syracuse clipboard modification 2014 malicious applications may monitor the clipboard activity through the code clipboardmanager onprimaryclipchangedlistener code interface on android to determine when the clipboard contents have changed citation dr webb clipboard modification origin2 august 2018 citation dr webb clipboard modification origin august 2018 listening to clipboard activity reading the clipboard contents and modifying the clipboard contents requires no explicit application permissions and can be performed by applications running in the background however this behavior has changed with the release of android 10 citation android 10 privacy changes adversaries may use clipboard modification https attack mitre org techniques t1510 to replace text prior to being pasted for example replacing a copied bitcoin wallet address with a wallet address that is under adversarial control clipboard modification https attack mitre org techniques t1510 had been seen within the android clipper c trojan this sample had been detected by eset in an application distributed through the google play store targeting cryptocurrency wallet numbers citation eset clipboard modification february 2019 ,Clipboard Modification
adversaries may compress and or encrypt data that is collected prior to exfiltration compressing data can help to obfuscate its contents and minimize use of network resources encryption can be used to hide information that is being exfiltrated from detection or make exfiltration less conspicuous upon inspection by a defender both compression and encryption are done prior to exfiltration and can be performed using a utility programming library or custom algorithm ,Archive Collected Data
adversaries may use a device s geographical location to limit certain malicious behaviors for example malware operators may limit the distribution of a second stage payload to certain geographic regions citation lookout esurv geofencing https attack mitre org techniques t1627 001 is accomplished by persuading the user to grant the application permission to access location services the application can then collect process and exfiltrate the device s location to perform location based actions such as ceasing malicious behavior or showing region specific advertisements one method to accomplish geofencing https attack mitre org techniques t1627 001 on android is to use the built in geofencing api to automatically trigger certain behaviors when the device enters or exits a specified radius around a geographical location similar to other geofencing https attack mitre org techniques t1627 001 methods this requires that the user has granted the access_fine_location and access_background_location permissions the latter is only required if the application targets android 10 api level 29 or higher however android 11 introduced additional permission controls that may restrict background location collection based on user permission choices at runtime these additional controls include allow only while using the app which will effectively prohibit background location collection similarly on ios developers can use built in apis to setup and execute geofencing depending on the use case the app will either need to call requestwheninuseauthorization or requestalwaysauthorization depending on when access to the location services is required similar to android users also have the option to limit when the application can access the device s location including one time use and only when the application is running in the foreground geofencing https attack mitre org techniques t1627 001 can be used to prevent exposure of capabilities in environments that are not intended to be compromised or operated within for example location data could be used to limit malware spread and or capabilities which could also potentially evade application analysis environments ex malware analysis outside of the target geographic area other malicious usages could include showing language specific input prompts and or advertisements ,Geofencing
adversaries may use device sensors to collect information about nearby networks such as wi fi and bluetooth ,Network Information Discovery
a malicious application could capture sensitive data sent via sms including authentication credentials sms is frequently used to transmit codes used for multi factor authentication on android a malicious application must request and obtain permission either at app install time or run time in order to receive sms messages alternatively a malicious application could attempt to perform an operating system privilege escalation attack to bypass the permission requirement on ios applications cannot access sms messages in normal operation so an adversary would need to attempt to perform an operating system privilege escalation attack to potentially be able to access sms messages ,Capture SMS Messages
adversaries may attempt to hide multimedia files from the user by doing so adversaries may conceal captured files such as pictures videos and or screenshots then later exfiltrate those files specific to android devices if the nomedia file is present in a folder multimedia files in that folder will not be visible to the user in the gallery application additionally other applications are asked not to scan the folder with the nomedia file effectively making the folder appear invisible to the user this technique is often used by stalkerware and spyware applications ,Conceal Multimedia Files
adversaries may perform endpoint denial of service dos attacks to degrade or block the availability of services to users on android versions prior to 7 apps can abuse device administrator access to reset the device lock passcode preventing the user from unlocking the device after android 7 only device or profile owners e g mdms can reset the device s passcode citation android resetpassword on ios devices this technique does not work because mobile device management servers can only remove the screen lock passcode they cannot set a new passcode however on jailbroken devices malware has been discovered that can lock the user out of the device citation xiao keyraider ,Endpoint Denial of Service
adversaries may communicate with compromised devices using out of band data streams this could be done for a variety of reasons including evading network traffic monitoring as a backup method of command and control or for data exfiltration if the device is not connected to any internet providing networks i e cellular or wi fi several out of band data streams exist such as sms messages nfc and bluetooth on android applications can read push notifications to capture content from sms messages or other out of band data streams this requires that the user manually grant notification access to the application via the settings menu however the application could launch an intent to take the user directly there on ios there is no way to programmatically read push notifications ,Out of Band Data
adversaries may explicitly employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol despite the use of a secure algorithm these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and or generated within malware samples configuration files ,Encrypted Channel
a malicious app or other attack vector could be used to exploit vulnerabilities in code running within the trusted execution environment tee citation thomas trustzone the adversary could then obtain privileges held by the tee potentially including the ability to access cryptographic keys or other sensitive data citation qualcommkeymaster escalated operating system privileges may be first required in order to have the ability to attack the tee citation ekbergtee if not privileges within the tee can potentially be used to exploit the operating system citation laginimaineb tee ,Exploit TEE Vulnerability
a malicious application could suppress its icon from being displayed to the user in the application launcher this hides the fact that it is installed and can make it more difficult for the user to uninstall the application hiding the application s icon programmatically does not require any special permissions this behavior has been seen in the bankbot spy banker family of malware citation android trojan steals paypal 2fa citation sunny stolen credentials citation bankbot spybanker beginning in android 10 changes were introduced to inhibit malicious applications ability to hide their icon if an app is a system app requests no permissions or does not have a launcher activity the application s icon will be fully hidden further if the device is fully managed or the application is in a work profile the icon will be fully hidden otherwise a synthesized activity is shown which is a launcher icon that represents the app s details page in the system settings if the user clicks the synthesized activity in the launcher they are taken to the application s details page in the system settings citation android 10 limitations to hiding app icons citation launcherapps getactivitylist ,Suppress Application Icon
if an adversary can escalate privileges he or she may be able to use those privileges to place malicious code in the device s trusted execution environment tee or other similar isolated execution environment where the code can evade detection may persist after device resets and may not be removable by the device user running code within the tee may provide an adversary with the ability to monitor or tamper with overall device behavior citation roth rootkits ,Modify Trusted Execution Environment
,Device Unlock Code Guessing or Brute Force
an adversary could cause the mobile device to use less secure protocols for example by jamming frequencies used by newer protocols such as lte and only allowing older protocols such as gsm to communicate citation nist sp800187 use of less secure protocols may make communication easier to eavesdrop upon or manipulate ,Downgrade to Insecure Protocols
adversaries may attempt to manipulate features of their artifacts to make them appear legitimate or benign to users and or security tools masquerading occurs when the name location or appearance of an object legitimate or malicious is manipulated or abused for the sake of evading defenses and observation this may include manipulating file metadata tricking users into misidentifying the file type and giving legitimate task or service names renaming abusable system utilities to evade security monitoring is also a form of masquerading https attack mitre org techniques t1655 ,Masquerading
an adversary could seek to generate fraudulent advertising revenue from mobile devices for example by triggering automatic clicks of advertising links without user involvement ,Generate Fraudulent Advertising Revenue
,Malicious or Vulnerable Built-in Device Functionality
adversaries may use steganography techniques in order to prevent the detection of hidden information steganographic techniques can be used to hide data in digital media such as images audio tracks video clips or text files ,Steganography
an adversary could exploit signaling system vulnerabilities to redirect calls or text messages sms to a phone number under the attacker s control the adversary could then act as an adversary in the middle to intercept or manipulate the communication citation engel ss7 citation engel ss7 2008 citation 3gpp security citation positive ss7 citation csric5 wg10 finalreport interception of sms messages could enable adversaries to obtain authentication codes used for multi factor authentication citation theregister ss7 ,Exploit SS7 to Redirect Phone Calls/SMS
adversaries may attempt to hide artifacts associated with their behaviors to evade detection mobile operating systems have features and developer apis to hide various artifacts such as an application s launcher icon these apis have legitimate usages such as hiding an icon to avoid application drawer clutter when an application does not have a usable interface adversaries may abuse these features and apis to hide artifacts from the user to evade detection ,Hide Artifacts
adversaries may modify code signing policies to enable execution of applications signed with unofficial or unknown keys code signing provides a level of authenticity on an app from a developer guaranteeing that the program has not been tampered with and comes from an official source security controls can include enforcement mechanisms to ensure that only valid signed code can be run on a device mobile devices generally enable these security controls by default such as preventing the installation of unknown applications on android adversaries may modify these policies in a number of ways including input injection https attack mitre org techniques t1516 or malicious configuration profiles ,Code Signing Policy Modification
adversaries may use domain generation algorithms https attack mitre org techniques t1637 001 dgas to procedurally generate domain names for uses such as command and control communication or malicious application distribution citation securelist rotexy 2018 dgas increase the difficulty for defenders to block track or take over the command and control channel as there could potentially be thousands of domains that malware can check for instructions ,Domain Generation Algorithms
adversaries may gain access to a system through a user visiting a website over the normal course of browsing with this technique the user s web browser is typically targeted for exploitation but adversaries may also use compromised websites for non exploitation behavior such as acquiring an application access token https attack mitre org techniques t1550 001 multiple ways of delivering exploit code to a browser exist including a legitimate website is compromised where adversaries have injected some form of malicious code such as javascript iframes and cross site scripting malicious ads are paid for and served through legitimate ad providers built in web application interfaces are leveraged for the insertion of any other kind of object that can be used to display web content or contain a script that executes on the visiting client e g forum posts comments and other user controllable web content often the website used by an adversary is one visited by a specific community such as government a particular industry or region where the goal is to compromise a specific user or set of users based on a shared interest this kind of targeted attack is referred to a strategic web compromise or watering hole attack there are several known examples of this occurring citation lookout stealthmango typical drive by compromise process 1 a user visits a website that is used to host the adversary controlled content 2 scripts automatically execute typically searching versions of the browser and plugins for a potentially vulnerable version the user may be required to assist in this process by enabling scripting or active website components and ignoring warning dialog boxes 3 upon finding a vulnerable version exploit code is delivered to the browser 4 if exploitation is successful then it will give the adversary code execution on the user s system unless other protections are in place in some cases a second visit to the website after the initial scan is required before exploit code is delivered ,Drive-By Compromise
a malicious application could suppress its icon from being displayed to the user in the application launcher to hide the fact that it is installed and to make it more difficult for the user to uninstall the application hiding the application s icon programmatically does not require any special permissions this behavior has been seen in the bankbot spy banker family of malware citation android trojan steals paypal 2fa citation sunny stolen credentials citation bankbot spybanker ,Suppress Application Icon
